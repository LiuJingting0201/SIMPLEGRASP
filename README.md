<<<<<<< HEAD
# è‡ªç›‘ç£æŠ“å–å¯ä¾›æ€§ï¼ˆAffordanceï¼‰æ•°æ®æ”¶é›†ç³»ç»Ÿ

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„è‡ªç›‘ç£æŠ“å–å¯ä¾›æ€§æ•°æ®æ”¶é›†ç³»ç»Ÿï¼Œç”¨äºŽç”Ÿæˆè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡åž‹æ‰€éœ€çš„è‡ªæ ‡æ³¨æ•°æ®é›†ã€‚

## ðŸŽ¯ ç³»ç»Ÿæ¦‚è¿°

æœ¬ç³»ç»Ÿå®žçŽ°äº†æ–¹æ¡ˆAçš„æ ¸å¿ƒæ€è·¯ï¼š
- åœ¨PyBulletä»¿çœŸçŽ¯å¢ƒä¸­è‡ªåŠ¨ç”Ÿæˆè‡ªæ ‡æ³¨æ•°æ®
- å¯¹æ¯ä¸€å¸§RGB-Då›¾åƒé‡‡æ ·è‹¥å¹²æŠ“å–å€™é€‰ç‚¹ (u,v,Î¸)
- ç”¨ç‰©ç†ä»¿çœŸ"è¯•æŠ“"æ‰“æ ‡ç­¾ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰
- ç”Ÿæˆåƒç´ çº§å¯ä¾›æ€§çƒ­åŠ›å›¾å’ŒæŠ“å–è§’åº¦å›¾

## ðŸ“ æ–‡ä»¶ç»“æž„

```
affordance_workspace/
â”œâ”€â”€ src/                          # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ environment_setup.py      # çŽ¯å¢ƒå’Œç‰©ä½“è®¾ç½®
â”‚   â”œâ”€â”€ perception.py             # ç›¸æœºæ„ŸçŸ¥å’Œå›¾åƒå¤„ç†
â”‚   â”œâ”€â”€ geom.py                   # å‡ ä½•å˜æ¢å’ŒæŠ“å–æµ‹è¯•
â”‚   â””â”€â”€ afford_data_gen.py        # åŽŸå§‹æ•°æ®ç”Ÿæˆå™¨
â”œâ”€â”€ sim_afford_data.py            # ðŸ”¥ å¯ä¾›æ€§æ•°æ®æ”¶é›†å™¨ (ä¸»è¦è„šæœ¬)
â”œâ”€â”€ visualize_affordance.py       # ðŸŽ¨ æ•°æ®å¯è§†åŒ–å·¥å…·
â”œâ”€â”€ test_affordance_pipeline.py   # ðŸ§ª ç®¡é“æµ‹è¯•è„šæœ¬
â””â”€â”€ data/
    â””â”€â”€ affordance_dataset/       # ç”Ÿæˆçš„æ•°æ®é›†
        â”œâ”€â”€ scene_0000_rgb.png    # RGBå›¾åƒ
        â”œâ”€â”€ scene_0000_depth.npy  # æ·±åº¦å›¾åƒ
        â”œâ”€â”€ scene_0000_affordance.npy  # å¯ä¾›æ€§çƒ­åŠ›å›¾
        â”œâ”€â”€ scene_0000_angles.npy # æœ€ä½³æŠ“å–è§’åº¦å›¾
        â””â”€â”€ scene_0000_meta.json  # å…ƒæ•°æ®
```

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 1. æµ‹è¯•ç³»ç»Ÿç®¡é“
```bash
python3 test_affordance_pipeline.py
```

### 2. å°è§„æ¨¡æ•°æ®æ”¶é›†ï¼ˆç”¨äºŽéªŒè¯ï¼‰
```bash
python3 sim_afford_data.py --num_scenes 10 --num_samples 30 --visualize
```

### 3. å¤§è§„æ¨¡æ•°æ®æ”¶é›†ï¼ˆç”¨äºŽè®­ç»ƒï¼‰
```bash
python3 sim_afford_data.py --num_scenes 1000 --num_samples 50
```

### 4. æ•°æ®å¯è§†åŒ–
```bash
# æŸ¥çœ‹å•ä¸ªåœºæ™¯
python3 visualize_affordance.py --scene_id 0

# åˆ†æžæ•´ä¸ªæ•°æ®é›†
python3 visualize_affordance.py --analyze
```

## ðŸ“Š æ•°æ®æ ¼å¼è¯´æ˜Ž

### è¾“å…¥æ•°æ®
- **RGBå›¾åƒ**: (480, 640, 3) uint8 å½©è‰²å›¾åƒ
- **æ·±åº¦å›¾åƒ**: (480, 640) float32 æ·±åº¦å€¼ï¼ˆç±³ï¼‰

### è¾“å‡ºæ ‡ç­¾
- **å¯ä¾›æ€§çƒ­åŠ›å›¾**: (480, 640) float32ï¼Œæ¯ä¸ªåƒç´ çš„æœ€ä½³æŠ“å–æˆåŠŸæ¦‚çŽ‡ [0-1]
- **è§’åº¦å›¾**: (480, 640) int8ï¼Œæ¯ä¸ªåƒç´ çš„æœ€ä½³æŠ“å–è§’åº¦ç´¢å¼• [-1 to 7]
  - -1: æ— æœ‰æ•ˆæŠ“å–
  - 0-7: å¯¹åº”0Â°, 45Â°, 90Â°, 135Â°, 180Â°, 225Â°, 270Â°, 315Â°

### å…ƒæ•°æ®
```json
{
  "scene_id": 0,
  "image_size": [640, 480],
  "num_angles": 8,
  "grasp_angles_rad": [0.0, 0.785, 1.571, ...],
  "camera_intrinsics": [[fx, 0, cx], [0, fy, cy], [0, 0, 1]],
  "num_candidates": 50,
  "success_rate": 0.34,
  "candidates": [[u, v, angle_idx], ...],
  "results": [true, false, ...]
}
```

## âš™ï¸ æ ¸å¿ƒå‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜Ž |
|------|--------|------|
| `--num_scenes` | 100 | è¦æ”¶é›†çš„åœºæ™¯æ•°é‡ |
| `--num_objects` | [3, 5] | æ¯ä¸ªåœºæ™¯çš„ç‰©ä½“æ•°é‡èŒƒå›´ |
| `--num_samples` | 50 | æ¯ä¸ªåœºæ™¯çš„æŠ“å–å€™é€‰ç‚¹æ•°é‡ |
| `--num_angles` | 8 | ç¦»æ•£åŒ–æŠ“å–è§’åº¦æ•°é‡ |
| `--visualize` | False | å¯ç”¨å¯è§†åŒ–ï¼ˆä»…ç¬¬ä¸€ä¸ªåœºæ™¯ï¼‰ |

## ðŸ”¬ æŠ€æœ¯ç»†èŠ‚

### æŠ“å–å€™é€‰ç‚¹é‡‡æ ·
- åœ¨æœ‰æ·±åº¦å€¼ä¸”åœ¨ç‰©ä½“ä¸Šçš„åƒç´ ä¸­éšæœºé‡‡æ ·
- æ¯ä¸ªå€™é€‰ç‚¹åŒ…å«åƒç´ åæ ‡ (u,v) å’ŒéšæœºæŠ“å–è§’åº¦
- é€šè¿‡ç›¸æœºå†…å‚å°†åƒç´ åæ ‡åæŠ•å½±åˆ°3Dä¸–ç•Œåæ ‡

### æŠ“å–ä»¿çœŸæµ‹è¯•
- ä½¿ç”¨Franka Pandaæœºæ¢°è‡‚è¿›è¡ŒæŠ“å–ä»¿çœŸ
- æ¯ä¸ªæµ‹è¯•åŒ…å«ï¼šæŽ¥è¿‘â†’æŠ“å–â†’æŠ¬èµ·â†’æˆåŠŸåˆ¤æ–­
- æˆåŠŸæ ‡å‡†ï¼šæŠ“å–åŽç‰©ä½“é«˜åº¦æå‡è¶…è¿‡é˜ˆå€¼

### å¯ä¾›æ€§åœ°å›¾ç”Ÿæˆ
- å°†æ‰€æœ‰æµ‹è¯•ç»“æžœæ˜ å°„å›žåƒç´ åæ ‡
- å¯¹æ¯ä¸ªåƒç´ ï¼Œè®¡ç®—å„è§’åº¦çš„æˆåŠŸçŽ‡
- é€‰æ‹©æˆåŠŸçŽ‡æœ€é«˜çš„è§’åº¦ä½œä¸ºè¯¥åƒç´ çš„æœ€ä½³æŠ“å–æ–¹å‘

## ðŸŽ¯ æŽ¨èçš„æ•°æ®æ”¶é›†ç­–ç•¥

### é˜¶æ®µ1ï¼šå¿«é€ŸéªŒè¯ (5-10ä¸ªåœºæ™¯)
```bash
python3 sim_afford_data.py --num_scenes 10 --num_samples 20 --visualize
```

### é˜¶æ®µ2ï¼šåŽŸåž‹å¼€å‘ (100-200ä¸ªåœºæ™¯)
```bash
python3 sim_afford_data.py --num_scenes 200 --num_samples 50
```

### é˜¶æ®µ3ï¼šæ¨¡åž‹è®­ç»ƒ (1000-2000ä¸ªåœºæ™¯)
```bash
python3 sim_afford_data.py --num_scenes 2000 --num_samples 100
```

## ðŸ“ˆ æ€§èƒ½è€ƒè™‘

- **å•åœºæ™¯æ”¶é›†æ—¶é—´**: ~30-60ç§’ï¼ˆå–å†³äºŽé‡‡æ ·ç‚¹æ•°é‡ï¼‰
- **æŽ¨èå¹¶è¡Œç­–ç•¥**: å¯ä»¥åœ¨å¤šå°æœºå™¨ä¸Šå¹¶è¡Œè¿è¡Œä¸åŒscene_idèŒƒå›´
- **å­˜å‚¨éœ€æ±‚**: æ¯ä¸ªåœºæ™¯çº¦1-2MBï¼ˆRGBå›¾åƒå ä¸»è¦ç©ºé—´ï¼‰

## ðŸ”§ æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

1. **ç‰©ä½“ç”Ÿæˆè¿‡å°‘**
   - æ£€æŸ¥ `--num_objects` å‚æ•°
   - ç¡®ä¿å·¥ä½œç©ºé—´è¶³å¤Ÿå¤§

2. **æŠ“å–æˆåŠŸçŽ‡è¿‡ä½Ž**
   - æ£€æŸ¥ç‰©ä½“å¤§å°æ˜¯å¦é€‚åˆæœºæ¢°è‡‚æŠ“æ‰‹
   - è°ƒæ•´æŠ“å–æµ‹è¯•çš„åˆ¤æ–­æ ‡å‡†

3. **å¯è§†åŒ–å¼‚å¸¸**
   - ç¡®ä¿å®‰è£…äº†matplotlibå’Œcv2
   - æ£€æŸ¥æ•°æ®æ–‡ä»¶æ˜¯å¦å®Œæ•´ç”Ÿæˆ

### è°ƒè¯•æ¨¡å¼
```bash
python3 sim_afford_data.py --num_scenes 1 --num_samples 10 --visualize
```

## ðŸŽ¨ å¯è§†åŒ–åŠŸèƒ½

ç³»ç»Ÿæä¾›ä¸°å¯Œçš„å¯è§†åŒ–åŠŸèƒ½ï¼š
- åŽŸå§‹RGBå›¾åƒ
- å¯ä¾›æ€§çƒ­åŠ›å›¾
- æœ€ä½³æŠ“å–è§’åº¦å›¾
- çƒ­åŠ›å›¾å åŠ æ•ˆæžœ
- é‡‡æ ·ç‚¹åˆ†å¸ƒï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰
- æŠ“å–æ–¹å‘ç®­å¤´
- æ•°æ®é›†ç»Ÿè®¡åˆ†æž

## ðŸ”® ä¸‹ä¸€æ­¥ï¼šU-Netè®­ç»ƒ

æ”¶é›†åˆ°è¶³å¤Ÿæ•°æ®åŽï¼Œå¯ä»¥ï¼š
1. åˆ›å»ºPyTorchæ•°æ®åŠ è½½å™¨è¯»å–è¿™äº›æ•°æ®
2. è®¾è®¡è½»é‡U-Netæž¶æž„
3. è®­ç»ƒåƒç´ çº§åˆ†ç±»/å›žå½’æ¨¡åž‹
4. å®žçŽ°åœ¨çº¿æŽ¨ç†å’Œæœºæ¢°è‡‚æŽ§åˆ¶

## ðŸ“š å¼•ç”¨å’Œå‚è€ƒ

è¿™ä¸ªç³»ç»Ÿä¸ºå®žçŽ°"è‡ªç›‘ç£æŠ“å–å¯ä¾›æ€§çƒ­åŠ›å›¾"æä¾›äº†å®Œæ•´çš„æ•°æ®æ”¶é›†ç®¡é“ï¼Œç¬¦åˆçŽ°ä»£æœºå™¨äººå­¦ä¹ çš„æœ€ä½³å®žè·µã€‚
=======
# SIMPLEGRASP
>>>>>>> 436b2c4942c01436f9fd1f44d399f94f0dc1e548
